totals = append(totals,i)
totals = append(totals,rep(i[[length(i)]],n))
animate.list = lappend(animate.list,totals)
o = o + 1
n = n - 1
totals = c()
}
years = as.factor(c(1970:2014))
staggered.dat = data.frame(year = years, matrix(unlist(animate.list),nrow=45,byrow=T))
staggered.dat$final = staggered.dat[,ncol(staggered.dat)]
trace.bar = function(column) {
p = ggplot(staggered.dat,
aes_string(colnames(staggered.dat)[1],colnames(staggered.dat)[column],fill=colnames(staggered.dat)[column])) +
geom_bar(stat="identity",width=.65) +
geom_line(data=othersectors,aes(x=year,y=perc.gdp)) +
labs(x="Year\n\nSource: Bureau of Economic Analysis\nhttp://cepr.net",y="Percent of GDP") +
scale_y_continuous(breaks = seq(0,max(dat$perc.gdp),by=.5),
expand = c(0,0),
labels=paste(seq(0,max(dat$perc.gdp),by=.5),"%",sep="")) +
scale_fill_continuous(guide=F) +
coord_cartesian(ylim=c(0,max(dat$perc.gdp)+.1)) +
ggtitle("Financial Sector Employee Compensation as Share of GDP, 1970-2014") +
theme(panel.background=element_blank(),
axis.text.x=element_text(family="Verdana",size=10,angle=90,vjust=.5),
axis.text.y=element_text(family="Verdana",size=10),
axis.line.y=element_line(size=.15),
axis.line.x=element_line(size=.15),
axis.title.x=element_text(family="Verdana",size=12),
axis.title.y=element_text(family="Verdana",size=12),
plot.title=element_text(family="Verdana",face="bold",size=13))
print(p)
}
trace.animate <- function() {
lapply(seq(2,49,1), function(i) {
trace.bar(i)
})
}
saveGIF(trace.animate(),interval=.45,movie.name = "financial-sector-1970-2014.gif", ani.height=450, ani.width=600)
source('/var/host/media/removable/USB DISK/CEPR/Papers/ftt-potential-revenues-2016-07/raw/animate.R', echo=TRUE)
source('/var/host/media/removable/USB DISK/CEPR/Papers/ftt-potential-revenues-2016-07/raw/othersectors.R', echo=TRUE)
trace.bar = function(column) {
p = ggplot(staggered.dat,
aes_string(colnames(staggered.dat)[1],colnames(staggered.dat)[column],fill=colnames(staggered.dat)[column])) +
geom_bar(stat="identity",width=.65) +
geom_line(data=othersectors,aes(x=year,y=perc.gdp)) +
labs(x="Year\n\nSource: Bureau of Economic Analysis\nhttp://cepr.net",y="Percent of GDP") +
scale_y_continuous(breaks = seq(0,max(dat$perc.gdp),by=.5),
expand = c(0,0),
labels=paste(seq(0,max(dat$perc.gdp),by=.5),"%",sep="")) +
scale_fill_continuous(guide=F) +
coord_cartesian(ylim=c(0,max(dat$perc.gdp)+.1)) +
ggtitle("Financial Sector Employee Compensation as Share of GDP, 1970-2014") +
theme(panel.background=element_blank(),
axis.text.x=element_text(family="Verdana",size=10,angle=90,vjust=.5),
axis.text.y=element_text(family="Verdana",size=10),
axis.line.y=element_line(size=.15),
axis.line.x=element_line(size=.15),
axis.title.x=element_text(family="Verdana",size=12),
axis.title.y=element_text(family="Verdana",size=12),
plot.title=element_text(family="Verdana",face="bold",size=13))
print(p)
}
trace.animate <- function() {
lapply(seq(2,49,1), function(i) {
trace.bar(i)
})
}
saveGIF(trace.animate(),interval=.45,movie.name = "financial-sector-1970-2014.gif", ani.height=450, ani.width=600)
trace.bar = function(column) {
p = ggplot(staggered.dat,
aes_string(colnames(staggered.dat)[1],colnames(staggered.dat)[column],fill=colnames(staggered.dat)[column])) +
geom_bar(stat="identity",width=.65) +
#    geom_line(data=othersectors,aes(x=year,y=perc.gdp)) +
labs(x="Year\n\nSource: Bureau of Economic Analysis\nhttp://cepr.net",y="Percent of GDP") +
scale_y_continuous(breaks = seq(0,max(dat$perc.gdp),by=.5),
expand = c(0,0),
labels=paste(seq(0,max(dat$perc.gdp),by=.5),"%",sep="")) +
scale_fill_continuous(guide=F) +
coord_cartesian(ylim=c(0,max(dat$perc.gdp)+.1)) +
ggtitle("Financial Sector Employee Compensation as Share of GDP, 1970-2014") +
theme(panel.background=element_blank(),
axis.text.x=element_text(family="Verdana",size=10,angle=90,vjust=.5),
axis.text.y=element_text(family="Verdana",size=10),
axis.line.y=element_line(size=.15),
axis.line.x=element_line(size=.15),
axis.title.x=element_text(family="Verdana",size=12),
axis.title.y=element_text(family="Verdana",size=12),
plot.title=element_text(family="Verdana",face="bold",size=13))
print(p)
}
trace.animate <- function() {
lapply(seq(2,49,1), function(i) {
trace.bar(i)
})
}
saveGIF(trace.animate(),interval=.45,movie.name = "financial-sector-1970-2014.gif", ani.height=450, ani.width=600)
ggplot() + geom_line(data=othersectors,aes(x=year,y=perc.gdp))
ggplot() + geom_line(data=othersectors,aes(x=year,y=perc.gdp,group=""))
ggplot() + geom_line(data=othersectors,aes(x=year,y=perc.gdp,group=""),color="red")
trace.bar = function(column) {
p = ggplot(staggered.dat,
aes_string(colnames(staggered.dat)[1],colnames(staggered.dat)[column],fill=colnames(staggered.dat)[column])) +
geom_bar(stat="identity",width=.65) +
geom_line(data=othersectors,aes(x=year,y=perc.gdp,group=""),color="red") +
labs(x="Year\n\nSource: Bureau of Economic Analysis\nhttp://cepr.net",y="Percent of GDP") +
scale_y_continuous(breaks = seq(0,max(dat$perc.gdp),by=.5),
expand = c(0,0),
labels=paste(seq(0,max(dat$perc.gdp),by=.5),"%",sep="")) +
scale_fill_continuous(guide=F) +
coord_cartesian(ylim=c(0,max(dat$perc.gdp)+.1)) +
ggtitle("Financial Sector Employee Compensation as Share of GDP, 1970-2014") +
theme(panel.background=element_blank(),
axis.text.x=element_text(family="Verdana",size=10,angle=90,vjust=.5),
axis.text.y=element_text(family="Verdana",size=10),
axis.line.y=element_line(size=.15),
axis.line.x=element_line(size=.15),
axis.title.x=element_text(family="Verdana",size=12),
axis.title.y=element_text(family="Verdana",size=12),
plot.title=element_text(family="Verdana",face="bold",size=13))
print(p)
}
trace.animate <- function() {
lapply(seq(2,49,1), function(i) {
trace.bar(i)
})
}
saveGIF(trace.animate(),interval=.45,movie.name = "financial-sector-1970-2014.gif", ani.height=450, ani.width=600)
trace.bar(2)
p = ggplot(staggered.dat,
aes_string(colnames(staggered.dat)[1],colnames(staggered.dat)[2],fill=colnames(staggered.dat)[2])) +
geom_bar(stat="identity",width=.65) +
geom_line(data=othersectors,aes(x=year,y=perc.gdp,group=""),color="red") +
labs(x="Year\n\nSource: Bureau of Economic Analysis\nhttp://cepr.net",y="Percent of GDP") +
scale_y_continuous(breaks = seq(0,max(dat$perc.gdp),by=.5),
expand = c(0,0),
labels=paste(seq(0,max(dat$perc.gdp),by=.5),"%",sep="")) +
scale_fill_continuous(guide=F) +
coord_cartesian(ylim=c(0,max(dat$perc.gdp)+.1)) +
ggtitle("Financial Sector Employee Compensation as Share of GDP, 1970-2014") +
theme(panel.background=element_blank(),
axis.text.x=element_text(family="Verdana",size=10,angle=90,vjust=.5),
axis.text.y=element_text(family="Verdana",size=10),
axis.line.y=element_line(size=.15),
axis.line.x=element_line(size=.15),
axis.title.x=element_text(family="Verdana",size=12),
axis.title.y=element_text(family="Verdana",size=12),
plot.title=element_text(family="Verdana",face="bold",size=13))
print(p)
p = ggplot(staggered.dat,
aes_string(colnames(staggered.dat)[1],colnames(staggered.dat)[2],fill=colnames(staggered.dat)[2])) +
geom_bar(stat="identity",width=.65) +
labs(x="Year\n\nSource: Bureau of Economic Analysis\nhttp://cepr.net",y="Percent of GDP") +
scale_y_continuous(breaks = seq(0,max(dat$perc.gdp),by=.5),
expand = c(0,0),
labels=paste(seq(0,max(dat$perc.gdp),by=.5),"%",sep="")) +
scale_fill_continuous(guide=F) +
coord_cartesian(ylim=c(0,max(dat$perc.gdp)+.1)) +
ggtitle("Financial Sector Employee Compensation as Share of GDP, 1970-2014") +
geom_line(data=othersectors,aes(x=year,y=perc.gdp,group=""),color="red") +
theme(panel.background=element_blank(),
axis.text.x=element_text(family="Verdana",size=10,angle=90,vjust=.5),
axis.text.y=element_text(family="Verdana",size=10),
axis.line.y=element_line(size=.15),
axis.line.x=element_line(size=.15),
axis.title.x=element_text(family="Verdana",size=12),
axis.title.y=element_text(family="Verdana",size=12),
plot.title=element_text(family="Verdana",face="bold",size=13))
print(p)
View(staggered.dat)
p = ggplot(staggered.dat,
aes_string(colnames(staggered.dat)[1],colnames(staggered.dat)[2],fill=colnames(staggered.dat)[2])) +
geom_bar(stat="identity",width=.65) +
labs(x="Year\n\nSource: Bureau of Economic Analysis\nhttp://cepr.net",y="Percent of GDP") +
scale_y_continuous(breaks = seq(0,max(dat$perc.gdp),by=.5),
expand = c(0,0),
labels=paste(seq(0,max(dat$perc.gdp),by=.5),"%",sep="")) +
scale_fill_continuous(guide=F) +
coord_cartesian(ylim=c(0,max(dat$perc.gdp)+.1)) +
ggtitle("Financial Sector Employee Compensation as Share of GDP, 1970-2014") +
#  geom_line(data=othersectors,aes(x=year,y=perc.gdp,group=""),color="red") +
theme(panel.background=element_blank(),
axis.text.x=element_text(family="Verdana",size=10,angle=90,vjust=.5),
axis.text.y=element_text(family="Verdana",size=10),
axis.line.y=element_line(size=.15),
axis.line.x=element_line(size=.15),
axis.title.x=element_text(family="Verdana",size=12),
axis.title.y=element_text(family="Verdana",size=12),
plot.title=element_text(family="Verdana",face="bold",size=13))
print(p)
print(p)
ggdraw(p)
p = ggplot() +
geom_bar(staggered.dat,
aes_string(colnames(staggered.dat)[1],colnames(staggered.dat)[2],fill=colnames(staggered.dat)[2]),
stat="identity",width=.65) +
labs(x="Year\n\nSource: Bureau of Economic Analysis\nhttp://cepr.net",y="Percent of GDP") +
scale_y_continuous(breaks = seq(0,max(dat$perc.gdp),by=.5),
expand = c(0,0),
labels=paste(seq(0,max(dat$perc.gdp),by=.5),"%",sep="")) +
scale_fill_continuous(guide=F) +
coord_cartesian(ylim=c(0,max(dat$perc.gdp)+.1)) +
ggtitle("Financial Sector Employee Compensation as Share of GDP, 1970-2014") +
#  geom_line(data=othersectors,aes(x=year,y=perc.gdp,group=""),color="red") +
theme(panel.background=element_blank(),
axis.text.x=element_text(family="Verdana",size=10,angle=90,vjust=.5),
axis.text.y=element_text(family="Verdana",size=10),
axis.line.y=element_line(size=.15),
axis.line.x=element_line(size=.15),
axis.title.x=element_text(family="Verdana",size=12),
axis.title.y=element_text(family="Verdana",size=12),
plot.title=element_text(family="Verdana",face="bold",size=13))
p = ggplot() +
geom_bar(data=staggered.dat,
aes_string(colnames(staggered.dat)[1],colnames(staggered.dat)[2],fill=colnames(staggered.dat)[2]),
stat="identity",width=.65) +
labs(x="Year\n\nSource: Bureau of Economic Analysis\nhttp://cepr.net",y="Percent of GDP") +
scale_y_continuous(breaks = seq(0,max(dat$perc.gdp),by=.5),
expand = c(0,0),
labels=paste(seq(0,max(dat$perc.gdp),by=.5),"%",sep="")) +
scale_fill_continuous(guide=F) +
coord_cartesian(ylim=c(0,max(dat$perc.gdp)+.1)) +
ggtitle("Financial Sector Employee Compensation as Share of GDP, 1970-2014") +
#  geom_line(data=othersectors,aes(x=year,y=perc.gdp,group=""),color="red") +
theme(panel.background=element_blank(),
axis.text.x=element_text(family="Verdana",size=10,angle=90,vjust=.5),
axis.text.y=element_text(family="Verdana",size=10),
axis.line.y=element_line(size=.15),
axis.line.x=element_line(size=.15),
axis.title.x=element_text(family="Verdana",size=12),
axis.title.y=element_text(family="Verdana",size=12),
plot.title=element_text(family="Verdana",face="bold",size=13))
p
ggdraw(p)
trace.bar = function(column) {
p = ggplot() +
geom_bar(data=staggered.dat,
aes_string(colnames(staggered.dat)[1],colnames(staggered.dat)[column],fill=colnames(staggered.dat)[column]),stat="identity",width=.65) +
geom_line(data=othersectors,aes(x=year,y=perc.gdp,group=""),color="red") +
labs(x="Year\n\nSource: Bureau of Economic Analysis\nhttp://cepr.net",y="Percent of GDP") +
scale_y_continuous(breaks = seq(0,max(dat$perc.gdp),by=.5),
expand = c(0,0),
labels=paste(seq(0,max(dat$perc.gdp),by=.5),"%",sep="")) +
scale_fill_continuous(guide=F) +
coord_cartesian(ylim=c(0,max(dat$perc.gdp)+.1)) +
ggtitle("Financial Sector Employee Compensation as Share of GDP, 1970-2014") +
theme(panel.background=element_blank(),
axis.text.x=element_text(family="Verdana",size=10,angle=90,vjust=.5),
axis.text.y=element_text(family="Verdana",size=10),
axis.line.y=element_line(size=.15),
axis.line.x=element_line(size=.15),
axis.title.x=element_text(family="Verdana",size=12),
axis.title.y=element_text(family="Verdana",size=12),
plot.title=element_text(family="Verdana",face="bold",size=13))
print(p)
}
trace.animate <- function() {
lapply(seq(2,49,1), function(i) {
trace.bar(i)
})
}
saveGIF(trace.animate(),interval=.45,movie.name = "financial-sector-1970-2014.gif", ani.height=450, ani.width=600)
?annotate
trace.bar = function(column) {
p = ggplot() +
geom_bar(data=staggered.dat,
aes_string(colnames(staggered.dat)[1],colnames(staggered.dat)[column],fill=colnames(staggered.dat)[column]),stat="identity",width=.65) +
geom_line(data=othersectors,aes(x=year,y=perc.gdp,group=""),color="red") +
annotate("text", x="1970", y=0.55,label="Median Other Sectors",size=2) +
labs(x="Year\n\nSource: Bureau of Economic Analysis\nhttp://cepr.net",y="Percent of GDP") +
scale_y_continuous(breaks = seq(0,max(dat$perc.gdp),by=.5),
expand = c(0,0),
labels=paste(seq(0,max(dat$perc.gdp),by=.5),"%",sep="")) +
scale_fill_continuous(guide=F) +
coord_cartesian(ylim=c(0,max(dat$perc.gdp)+.1)) +
ggtitle("Financial Sector Employee Compensation as Share of GDP, 1970-2014") +
theme(panel.background=element_blank(),
axis.text.x=element_text(family="Verdana",size=10,angle=90,vjust=.5),
axis.text.y=element_text(family="Verdana",size=10),
axis.line.y=element_line(size=.15),
axis.line.x=element_line(size=.15),
axis.title.x=element_text(family="Verdana",size=12),
axis.title.y=element_text(family="Verdana",size=12),
plot.title=element_text(family="Verdana",face="bold",size=13))
print(p)
}
trace.bar(2)
trace.bar = function(column) {
p = ggplot() +
geom_bar(data=staggered.dat,
aes_string(colnames(staggered.dat)[1],colnames(staggered.dat)[column],fill=colnames(staggered.dat)[column]),stat="identity",width=.65) +
geom_line(data=othersectors,aes(x=year,y=perc.gdp,group=""),color="red") +
annotate("text", x="1970", y=0.55,label="Median Other Sectors",size=2,hjust=1) +
labs(x="Year\n\nSource: Bureau of Economic Analysis\nhttp://cepr.net",y="Percent of GDP") +
scale_y_continuous(breaks = seq(0,max(dat$perc.gdp),by=.5),
expand = c(0,0),
labels=paste(seq(0,max(dat$perc.gdp),by=.5),"%",sep="")) +
scale_fill_continuous(guide=F) +
coord_cartesian(ylim=c(0,max(dat$perc.gdp)+.1)) +
ggtitle("Financial Sector Employee Compensation as Share of GDP, 1970-2014") +
theme(panel.background=element_blank(),
axis.text.x=element_text(family="Verdana",size=10,angle=90,vjust=.5),
axis.text.y=element_text(family="Verdana",size=10),
axis.line.y=element_line(size=.15),
axis.line.x=element_line(size=.15),
axis.title.x=element_text(family="Verdana",size=12),
axis.title.y=element_text(family="Verdana",size=12),
plot.title=element_text(family="Verdana",face="bold",size=13))
print(p)
}
trace.bar(2)
trace.bar = function(column) {
p = ggplot() +
geom_bar(data=staggered.dat,
aes_string(colnames(staggered.dat)[1],colnames(staggered.dat)[column],fill=colnames(staggered.dat)[column]),stat="identity",width=.65) +
geom_line(data=othersectors,aes(x=year,y=perc.gdp,group=""),color="red") +
annotate("text", x="1970", y=0.55,label="Median Other Sectors",size=2,hjust=0) +
labs(x="Year\n\nSource: Bureau of Economic Analysis\nhttp://cepr.net",y="Percent of GDP") +
scale_y_continuous(breaks = seq(0,max(dat$perc.gdp),by=.5),
expand = c(0,0),
labels=paste(seq(0,max(dat$perc.gdp),by=.5),"%",sep="")) +
scale_fill_continuous(guide=F) +
coord_cartesian(ylim=c(0,max(dat$perc.gdp)+.1)) +
ggtitle("Financial Sector Employee Compensation as Share of GDP, 1970-2014") +
theme(panel.background=element_blank(),
axis.text.x=element_text(family="Verdana",size=10,angle=90,vjust=.5),
axis.text.y=element_text(family="Verdana",size=10),
axis.line.y=element_line(size=.15),
axis.line.x=element_line(size=.15),
axis.title.x=element_text(family="Verdana",size=12),
axis.title.y=element_text(family="Verdana",size=12),
plot.title=element_text(family="Verdana",face="bold",size=13))
print(p)
}
trace.bar(2)
trace.bar = function(column) {
p = ggplot() +
geom_bar(data=staggered.dat,
aes_string(colnames(staggered.dat)[1],colnames(staggered.dat)[column],fill=colnames(staggered.dat)[column]),stat="identity",width=.65) +
geom_line(data=othersectors,aes(x=year,y=perc.gdp,group=""),color="red") +
annotate("text", x="1970", y=0.55,label="Median Other Sectors",size=2,hjust=0,family="Verdana") +
labs(x="Year\n\nSource: Bureau of Economic Analysis\nhttp://cepr.net",y="Percent of GDP") +
scale_y_continuous(breaks = seq(0,max(dat$perc.gdp),by=.5),
expand = c(0,0),
labels=paste(seq(0,max(dat$perc.gdp),by=.5),"%",sep="")) +
scale_fill_continuous(guide=F) +
coord_cartesian(ylim=c(0,max(dat$perc.gdp)+.1)) +
ggtitle("Financial Sector Employee Compensation as Share of GDP, 1970-2014") +
theme(panel.background=element_blank(),
axis.text.x=element_text(family="Verdana",size=10,angle=90,vjust=.5),
axis.text.y=element_text(family="Verdana",size=10),
axis.line.y=element_line(size=.15),
axis.line.x=element_line(size=.15),
axis.title.x=element_text(family="Verdana",size=12),
axis.title.y=element_text(family="Verdana",size=12),
plot.title=element_text(family="Verdana",face="bold",size=13))
print(p)
}
trace.bar(2)
trace.animate <- function() {
lapply(seq(2,49,1), function(i) {
trace.bar(i)
})
}
saveGIF(trace.animate(),interval=.45,movie.name = "financial-sector-1970-2014.gif", ani.height=450, ani.width=600)
trace.bar = function(column) {
p = ggplot() +
geom_bar(data=staggered.dat,
aes_string(colnames(staggered.dat)[1],colnames(staggered.dat)[column],fill=colnames(staggered.dat)[column]),stat="identity",width=.65) +
geom_line(data=othersectors,aes(x=year,y=perc.gdp,group=""),color="red") +
annotate("text", x="1970", y=0.55,label="Median Other Sectors",size=4,hjust=0,family="Verdana") +
labs(x="Year\n\nSource: Bureau of Economic Analysis\nhttp://cepr.net",y="Percent of GDP") +
scale_y_continuous(breaks = seq(0,max(dat$perc.gdp),by=.5),
expand = c(0,0),
labels=paste(seq(0,max(dat$perc.gdp),by=.5),"%",sep="")) +
scale_fill_continuous(guide=F) +
coord_cartesian(ylim=c(0,max(dat$perc.gdp)+.1)) +
ggtitle("Financial Sector Employee Compensation as Share of GDP, 1970-2014") +
theme(panel.background=element_blank(),
axis.text.x=element_text(family="Verdana",size=10,angle=90,vjust=.5),
axis.text.y=element_text(family="Verdana",size=10),
axis.line.y=element_line(size=.15),
axis.line.x=element_line(size=.15),
axis.title.x=element_text(family="Verdana",size=12),
axis.title.y=element_text(family="Verdana",size=12),
plot.title=element_text(family="Verdana",face="bold",size=13))
print(p)
}
trace.bar(2)
saveGIF(trace.animate(),interval=.45,movie.name = "financial-sector-1970-2014.gif", ani.height=450, ani.width=600)
trace.bar = function(column) {
p = ggplot() +
geom_bar(data=staggered.dat,
aes_string(colnames(staggered.dat)[1],colnames(staggered.dat)[column],fill=colnames(staggered.dat)[column]),stat="identity",width=.65) +
geom_line(data=othersectors,aes(x=year,y=perc.gdp,group=""),color="red") +
annotate("text", x="1970", y=0.6,label="Median Other Sectors",size=3,hjust=0,family="Verdana") +
labs(x="Year\n\nSource: Bureau of Economic Analysis\nhttp://cepr.net",y="Percent of GDP") +
scale_y_continuous(breaks = seq(0,max(dat$perc.gdp),by=.5),
expand = c(0,0),
labels=paste(seq(0,max(dat$perc.gdp),by=.5),"%",sep="")) +
scale_fill_continuous(guide=F) +
coord_cartesian(ylim=c(0,max(dat$perc.gdp)+.1)) +
ggtitle("Financial Sector Employee Compensation as Share of GDP, 1970-2014") +
theme(panel.background=element_blank(),
axis.text.x=element_text(family="Verdana",size=10,angle=90,vjust=.5),
axis.text.y=element_text(family="Verdana",size=10),
axis.line.y=element_line(size=.15),
axis.line.x=element_line(size=.15),
axis.title.x=element_text(family="Verdana",size=12),
axis.title.y=element_text(family="Verdana",size=12),
plot.title=element_text(family="Verdana",face="bold",size=13))
print(p)
}
trace.bar(2)
trace.bar = function(column) {
p = ggplot() +
geom_bar(data=staggered.dat,
aes_string(colnames(staggered.dat)[1],colnames(staggered.dat)[column],fill=colnames(staggered.dat)[column]),stat="identity",width=.65) +
geom_line(data=othersectors,aes(x=year,y=perc.gdp,group=""),color="red") +
annotate("text", x="1970", y=0.6,label="Median Other Sectors",size=4,hjust=0,family="Verdana") +
labs(x="Year\n\nSource: Bureau of Economic Analysis\nhttp://cepr.net",y="Percent of GDP") +
scale_y_continuous(breaks = seq(0,max(dat$perc.gdp),by=.5),
expand = c(0,0),
labels=paste(seq(0,max(dat$perc.gdp),by=.5),"%",sep="")) +
scale_fill_continuous(guide=F) +
coord_cartesian(ylim=c(0,max(dat$perc.gdp)+.1)) +
ggtitle("Financial Sector Employee Compensation as Share of GDP, 1970-2014") +
theme(panel.background=element_blank(),
axis.text.x=element_text(family="Verdana",size=10,angle=90,vjust=.5),
axis.text.y=element_text(family="Verdana",size=10),
axis.line.y=element_line(size=.15),
axis.line.x=element_line(size=.15),
axis.title.x=element_text(family="Verdana",size=12),
axis.title.y=element_text(family="Verdana",size=12),
plot.title=element_text(family="Verdana",face="bold",size=13))
print(p)
}
trace.bar(2)
trace.bar = function(column) {
p = ggplot() +
geom_bar(data=staggered.dat,
aes_string(colnames(staggered.dat)[1],colnames(staggered.dat)[column],fill=colnames(staggered.dat)[column]),stat="identity",width=.65) +
geom_line(data=othersectors,aes(x=year,y=perc.gdp,group=""),color="red") +
annotate("text", x="1970", y=0.58,label="Median Other Sectors",size=4,hjust=0,family="Verdana") +
labs(x="Year\n\nSource: Bureau of Economic Analysis\nhttp://cepr.net",y="Percent of GDP") +
scale_y_continuous(breaks = seq(0,max(dat$perc.gdp),by=.5),
expand = c(0,0),
labels=paste(seq(0,max(dat$perc.gdp),by=.5),"%",sep="")) +
scale_fill_continuous(guide=F) +
coord_cartesian(ylim=c(0,max(dat$perc.gdp)+.1)) +
ggtitle("Financial Sector Employee Compensation as Share of GDP, 1970-2014") +
theme(panel.background=element_blank(),
axis.text.x=element_text(family="Verdana",size=10,angle=90,vjust=.5),
axis.text.y=element_text(family="Verdana",size=10),
axis.line.y=element_line(size=.15),
axis.line.x=element_line(size=.15),
axis.title.x=element_text(family="Verdana",size=12),
axis.title.y=element_text(family="Verdana",size=12),
plot.title=element_text(family="Verdana",face="bold",size=13))
print(p)
}
trace.animate <- function() {
lapply(seq(2,49,1), function(i) {
trace.bar(i)
})
}
saveGIF(trace.animate(),interval=.45,movie.name = "financial-sector-1970-2014.gif", ani.height=450, ani.width=600)
dat_98_14 = fread('data/1998-2014.csv',skip = 4, nrows=99, select=c(2:19))
sectors = c(5,6,8:10,11,12,15:25,27:34,36:37,39:42,44:51,53:56,58,60,63:64,66:68,69,
71:72,73,75:78,80:81,83:84,85,89:90,91,94:95,96)
datf_98_14 = dat_98_14[sectors,]
View(datf_98_14)
dat_88_97 = fread('data/1988-1997.csv',skip = 4, nrows=86, select=c(2:12))
sectors2 = c(5:6,8:11,15:25,27:36,39:45,47:48,49:51,53:54,56:58,61:70,72:75,79:81,84:86)
datf_88_97 = dat_88_97[sectors2,]
View(datf_88_97)
dat_70_87 = fread('data/1970-1987.csv',skip = 4, nrows=86, select=c(2:20))
datf_70_87 = dat_70_87[sectors2,]
View(datf_70_87)
source('/var/host/media/removable/USB DISK/CEPR/Papers/ftt-potential-revenues-2016-07/raw/othersectors.R', echo=TRUE)
trace.bar = function(column) {
p = ggplot() +
geom_bar(data=staggered.dat,
aes_string(colnames(staggered.dat)[1],colnames(staggered.dat)[column],fill=colnames(staggered.dat)[column]),stat="identity",width=.65) +
geom_line(data=othersectors,aes(x=year,y=perc.gdp,group=""),color="red") +
annotate("text", x="1970", y=0.58,label="Median Other Sectors",size=4,hjust=0,family="Verdana") +
labs(x="Year\n\nSource: Bureau of Economic Analysis\nhttp://cepr.net",y="Percent of GDP") +
scale_y_continuous(breaks = seq(0,max(dat$perc.gdp),by=.5),
expand = c(0,0),
labels=paste(seq(0,max(dat$perc.gdp),by=.5),"%",sep="")) +
scale_fill_continuous(guide=F) +
coord_cartesian(ylim=c(0,max(dat$perc.gdp)+.1)) +
ggtitle("Financial Sector Employee Compensation as Share of GDP, 1970-2014") +
theme(panel.background=element_blank(),
axis.text.x=element_text(family="Verdana",size=10,angle=90,vjust=.5),
axis.text.y=element_text(family="Verdana",size=10),
axis.line.y=element_line(size=.15),
axis.line.x=element_line(size=.15),
axis.title.x=element_text(family="Verdana",size=12),
axis.title.y=element_text(family="Verdana",size=12),
plot.title=element_text(family="Verdana",face="bold",size=13))
print(p)
}
trace.animate <- function() {
lapply(seq(2,49,1), function(i) {
trace.bar(i)
})
}
saveGIF(trace.animate(),interval=.45,movie.name = "financial-sector-1970-2014.gif", ani.height=450, ani.width=600)
dat_88_97 = fread('data/1988-1997.csv',skip = 4, nrows=86, select=c(2:12))
sectors2 = c(5:6,8:12,15:25,27:36,39:45,47:48,49:51,53:54,56:58,61:70,72:75,79:81,84:86)
datf_88_97 = dat_88_97[sectors2,]
View(datf_88_97)
