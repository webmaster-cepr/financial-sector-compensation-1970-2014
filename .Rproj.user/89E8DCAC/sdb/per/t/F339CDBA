{
    "contents" : "source('raw/exploratory.R')\n#source('raw/othersectors.R')\n\nrequire(animation)\n\nseq_list = mapply(seq,0,dat$perc.gdp,length.out=4L,SIMPLIFY = F)\n\nn = nrow(dat)\no = 0\ntotals = c()\n\nanimate.list = list()\n\nlappend = function(lst,...) {\n  lst = c(lst,list(...))\n  return(lst)\n}\n\nfor(i in seq_list) {\n totals = append(totals,rep(0,o))\n totals = append(totals,i)\n totals = append(totals,rep(i[[length(i)]],n))\n animate.list = lappend(animate.list,totals)\n o = o + 1\n n = n - 1\n totals = c()\n}\n\nyears = as.factor(c(1970:2014))\nstaggered.dat = data.frame(year = years, matrix(unlist(animate.list),nrow=45,byrow=T))\nstaggered.dat$final = staggered.dat[,ncol(staggered.dat)]\n\ntrace.bar = function(column) {\n  p = ggplot() +\n    geom_bar(data=staggered.dat,\n             aes_string(colnames(staggered.dat)[1],colnames(staggered.dat)[column],fill=colnames(staggered.dat)[column]),stat=\"identity\",width=.65) +\n    geom_line(data=othersectors,aes(x=year,y=perc.gdp,group=\"\"),color=\"red\") +\n    annotate(\"text\", x=\"1970\", y=0.58,label=\"Median Other Sectors\",size=4,hjust=0,family=\"Verdana\") +\n    labs(x=\"Year\\n\\nSource: Bureau of Economic Analysis\\nhttp://cepr.net\",y=\"Percent of GDP\") +\n    scale_y_continuous(breaks = seq(0,max(dat$perc.gdp),by=.5),\n                       expand = c(0,0),\n                       labels=paste(seq(0,max(dat$perc.gdp),by=.5),\"%\",sep=\"\")) +\n    scale_fill_continuous(guide=F) +\n    coord_cartesian(ylim=c(0,max(dat$perc.gdp)+.1)) +\n    ggtitle(\"Financial Sector Employee Compensation as Share of GDP, 1970-2014\") +\n    theme(panel.background=element_blank(),\n          axis.text.x=element_text(family=\"Verdana\",size=10,angle=90,vjust=.5),\n          axis.text.y=element_text(family=\"Verdana\",size=10),\n          axis.line.y=element_line(size=.15),\n          axis.line.x=element_line(size=.15),\n          axis.title.x=element_text(family=\"Verdana\",size=12),\n          axis.title.y=element_text(family=\"Verdana\",size=12),\n          plot.title=element_text(family=\"Verdana\",face=\"bold\",size=13))\n  print(p) \n} \n\ntrace.animate <- function() {\n  lapply(seq(2,49,1), function(i) {\n    trace.bar(i)\n  })\n}\n\nsaveGIF(trace.animate(),interval=.45,movie.name = \"financial-sector-1970-2014.gif\", ani.height=450, ani.width=600)\n",
    "created" : 1467901933914.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2406981826",
    "id" : "F339CDBA",
    "lastKnownWriteTime" : 1467911716,
    "path" : "/var/host/media/removable/USB DISK/CEPR/Papers/ftt-potential-revenues-2016-07/raw/animate.R",
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "type" : "r_source"
}