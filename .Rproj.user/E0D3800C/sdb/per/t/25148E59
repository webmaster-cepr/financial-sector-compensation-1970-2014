{
    "collab_server" : "",
    "contents" : "year = c(2002:2012)\nbenchmark = c(1.36,1.42,1.29,1.13,1.00,0.96,0.93,0.88,0.92,0.93,0.88)\n\ndf = data.frame(year=year, benchmark=benchmark)\n\ndf$year = as.factor(df$year)\n\nlibrary(ggplot2)\nlibrary(cowplot)\n\npme_p = ggplot(df,aes(year,benchmark-1,label=benchmark)) + geom_bar(stat=\"identity\",width=0.75,fill=\"#055c85\") +\n  geom_text(aes(y=(benchmark-1)+.015),size=4,family=\"Verdana\",color=c(rep(\"black\",5),rep(\"white\",6))) +\n  scale_y_continuous(breaks=seq(0.8-1,1.5-1,by=0.1),labels=seq(0.8,1.5,by=0.1)) +\n  labs(x=\"Vintage Year\",y=\"\") +\n  annotate(\"text\",\n           x=\"2012\",\n           y=1.4-1,\n           hjust=1,\n           label=\"PME calculated using Russell 3000* Index\\nSource:Pitchbook\",\n           size=4, family=\"Verdana\") +\n  ggtitle(\"PE KS PME Benchmark by Vintage\") +\n  theme(panel.background=element_blank(),\n        axis.text.x=element_text(family=\"Verdana\",size=9),\n        axis.text.y=element_text(family=\"Verdana\",size=9),\n        axis.line.y=element_line(size=.15),\n        axis.line.x=element_line(size=.15),\n        axis.title.x=element_text(family=\"Verdana\",size=10),\n        plot.title=element_text(family=\"Verdana\",face=\"bold\",size=15))\n\npme_final = add_sub(pme_p,\n                    \"When using a KS PME, a value greater than 1.0 indicates outperformance of the public index (net of all fees). For example, the 1.13 value\\nfor 2005 vintage PE funds means investors in a typical vehicle from that year are 13% better off having invested in a PE than if they had\\ninvested in public equities over the same period.\\n\\nSource and notes: PitchBook (2015 p.5)\\n\\nhttp://cepr.net\",\n                    x=0, hjust=0, fontfamily=\"Verdana\",size=10)\nggdraw(pme_final)\n\n\n# IRR DATA\n\nirr = read.csv(\"data/tabula-private-equity-performance-2016-06.csv\", stringsAsFactors = F)\nirr = t(irr)\n\n# cleaning up table\nirr_df = data.frame(\"Vintage.Year\"=rownames(irr),\n                    \"Top.Quartile.IRR.Hurdle\"=irr[,1],\n                    \"Median.IRR\"=irr[,2],\n                    \"Bottom.Quartile.IRR.Hurdle\"=irr[,3])\n# remove top row\nirr_df = irr_df[-1,]\n\nirr_df$Vintage.Year = as.factor(gsub(\"X\",\"\",irr_df$Vintage.Year))\n\nrownames(irr_df) = c(1:nrow(irr_df))\n\nrequire(dplyr)\n\n# converting to decimals\nirr_df = irr_df %>% mutate(Top.Quartile.IRR.Hurdle = as.numeric(as.character(Top.Quartile.IRR.Hurdle)) / 100,\n                  Median.IRR = as.numeric(as.character(Median.IRR)) / 100,\n                  Bottom.Quartile.IRR.Hurdle = as.numeric(as.character(Bottom.Quartile.IRR.Hurdle)) / 100)\n\ncolors = c('#012738','#055c85','#bad7f5')\n\nirr_p = ggplot(irr_df) + \n  geom_bar(aes(x=Vintage.Year, y=Top.Quartile.IRR.Hurdle, fill='Top Quartile'),stat=\"identity\",width=0.75) +\n  geom_bar(aes(x=Vintage.Year, y=Median.IRR, fill=\"Median\"),stat=\"identity\",width=0.5) +\n  geom_bar(aes(x=Vintage.Year, y=Bottom.Quartile.IRR.Hurdle, fill=\"Bottom Quartile\"),stat=\"identity\",width=0.25) +\n  labs(x=\"Vintage Year\",y=\"\") +\n  scale_y_continuous(breaks = seq(0.025,0.311,by=.05), labels=seq(0.025*100,0.311*100,by=.05*100), expand=c(0,0)) +\n  scale_fill_manual(values=colors,name=\"\") +\n  ggtitle(\"Private Equity Fund Performance (IRR), 2002-2012 (Percent)\") +\n  theme(panel.background=element_blank(),\n        axis.text.x=element_text(family=\"Verdana\",size=7.5),\n        axis.text.y=element_text(family=\"Verdana\",size=7.5),\n        axis.line.y=element_line(size=.15),\n        axis.line.x=element_line(size=.15),\n        axis.title.x=element_text(family=\"Verdana\",size=9),\n        legend.key=element_rect(fill=\"white\"),\n        legend.position=c(.85,.85),\n        legend.text=element_text(family=\"Verdana\",size=8),\n        plot.title=element_text(family=\"Verdana\",face=\"bold\",size=10.5))\nirr_p\n\nirr_final = add_sub(irr_p,\"http://cepr.net\\nSource and notes: PitchBook (2015 p.8)\",x=0, hjust=0, fontfamily=\"Verdana\",size=7.5)\nggdraw(irr_final)\n",
    "created" : 1467832600445.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "518166078",
    "id" : "25148E59",
    "lastKnownWriteTime" : 1467299076,
    "last_content_update" : 1467299076,
    "path" : "~/Documents/Papers/private-equity-performance-2016-06/figures.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}